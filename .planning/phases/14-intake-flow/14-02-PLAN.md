---
phase: 14-intake-flow
plan: 02
type: execute
wave: 2
depends_on:
  - 14-01
files_modified: []
autonomous: false
requirements:
  - INTAKE-02
  - INTAKE-03
  - INTAKE-04
  - INTAKE-05

must_haves:
  truths:
    - "Operator confirms Archie begins intake on intent signal (does not dispatch immediately)"
    - "Operator confirms grouped turn questioning — name+purpose asked together, not one field per turn"
    - "Operator confirms approval summary is shown before any dispatch"
    - "Operator confirms cancel resets intake cleanly without referencing cancelled config in next message"
  artifacts:
    - path: "instances/noah/config/EVENT_HANDLER.md"
      provides: "Deployed intake instructions visible to the running agent"
      contains: "Instance Creation Intake"
  key_links:
    - from: "instances/noah/config/EVENT_HANDLER.md"
      to: "Running Archie agent"
      via: "Docker rebuild or direct config volume mount — file must be active in running container"
      pattern: "Instance Creation Intake"
---

<objective>
Human verification of Archie's multi-turn intake behavior after the EVENT_HANDLER.md update from Plan 01.

Purpose: Instruction-driven LLM behavior cannot be verified with automated tests — the actual behavior requires a running agent. This checkpoint confirms the intake instructions work as intended across the 4 behavioral scenarios.

Output: Operator confirmation that all 4 requirements (INTAKE-02 through INTAKE-05) behave correctly in a live conversation.
</objective>

<execution_context>
@/Users/nwessel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/nwessel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-intake-flow/14-01-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Verify Archie's intake behavior in live conversation</name>
  <action>
    Ensure the running Archie agent has the updated EVENT_HANDLER.md active. Either:
    - Rebuild the Docker container: `docker compose build noah && docker compose up -d noah`
    - OR if running in dev with volume mount: restart the event handler process so it re-reads the file

    Then run the 4 scenarios described in how-to-verify.
  </action>
  <what-built>
    Instance Creation Intake section added to instances/noah/config/EVENT_HANDLER.md (Plan 01). This section teaches Archie to:
    - Begin multi-turn intake on intent signals like "create an instance for Jim"
    - Collect name+purpose (Turn 1), allowed_repos (Turn 2), enabled_channels (Turn 3) — grouped, not one field per turn
    - Capture slack_user_ids/telegram_chat_id silently if volunteered (no dedicated question)
    - Present a full config summary and wait for explicit approval before calling create_instance_job
    - Reset cleanly on cancel without carrying partial state forward
  </what-built>
  <how-to-verify>
    Run these 4 test scenarios in a conversation with Archie:

    **Scenario 1 — Intent recognition + grouped turns (INTAKE-02)**
    1. Say: "create an instance for Jim"
    2. Expected: Archie asks for name AND purpose in the same message (e.g., "What should I call this instance, and what is it for?") — NOT "What should the instance name be?" alone
    3. Pass: name + purpose asked together in Turn 1

    **Scenario 2 — Optional field volunteered mid-intake (INTAKE-03)**
    1. Continue from Scenario 1 or start fresh: "create an instance for Jim"
    2. When Archie asks for name/purpose, reply: "name is jim, purpose is StrategyES dev agent, Jim's Slack ID is U0ABC123"
    3. Expected: Archie captures U0ABC123 as slack_user_id WITHOUT asking a separate "What is the Slack user ID?" question. It should proceed to ask about allowed_repos.
    4. Pass: Archie does not ask a dedicated Slack user ID question; it appears in the eventual summary

    **Scenario 3 — Approval gate with summary (INTAKE-04)**
    1. Complete a full intake (name, purpose, repos, channels)
    2. Expected: Archie presents a formatted summary listing all collected fields, then says something like "Confirm with 'yes' to dispatch"
    3. Verify: Archie does NOT call create_instance_job until after you say "yes" (or similar affirmative)
    4. Pass: Summary shown before dispatch; job dispatched only after explicit approval

    **Scenario 4 — Cancellation reset (INTAKE-05)**
    1. Start intake: "create an instance for Jim"
    2. Provide name + purpose
    3. Then say: "never mind, cancel"
    4. Expected: Archie acknowledges cancellation and confirms intake is reset
    5. Then ask an unrelated question: "what repos does the noah instance have access to?"
    6. Expected: Archie answers the unrelated question WITHOUT referencing Jim or any cancelled intake values
    7. Pass: Cancellation acknowledged + clean response to next unrelated message

    Note: If create_instance_job dispatches a job during Scenario 3, that is expected — the stub handler from Phase 13 will run. Phase 15 builds the real job description generator.
  </how-to-verify>
  <verify>
    <automated>MISSING — LLM behavior verification requires a running agent; automated test not applicable for instruction-driven behavioral checks</automated>
    <manual>Run all 4 scenarios above and confirm each passes per the criteria described</manual>
  </verify>
  <done>All 4 behavioral scenarios pass: grouped turns, silent optional capture, approval gate with summary, clean cancellation reset.</done>
  <resume-signal>
    Type "approved" if all 4 scenarios pass.
    Or describe which scenario(s) failed and what Archie did instead — this becomes input for a gap closure plan.
  </resume-signal>
</task>

</tasks>

<verification>
All 4 scenarios pass per operator observation:
1. Turn 1 groups name + purpose (not one field at a time)
2. Volunteered optional fields captured without dedicated question turn
3. Config summary shown before dispatch; explicit approval required
4. Cancel resets cleanly; next unrelated message has no intake contamination
</verification>

<success_criteria>
- Archie recognizes instance creation intent and begins intake (does not dispatch immediately)
- Multi-turn collection groups related fields — no one-field-per-turn behavior
- Optional fields captured silently when volunteered
- Approval gate shows summary and waits for explicit confirmation
- Cancellation resets intake without polluting the next unrelated conversation turn
- Phase 14 complete — ready for Phase 15 (Job Prompt Completeness)
</success_criteria>

<output>
After completion, create `.planning/phases/14-intake-flow/14-02-SUMMARY.md`
</output>
